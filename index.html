<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet">

</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top shadow-sm">
            <a class="navbar-brand" href="#home">SHEMA Roger</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#home">HOME</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#about">ABOUT ME</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#portfolio">PORTFOLIO</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#blogs">BLOGS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contact">CONTACT ME</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Optional JavaScript; choose one of the two! -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <main>
         <section id="home" class="home py-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6 text-center text-md-left">
                    <div class="soft mb-4">
                        <h4>SOFTWARE ENGINEERING</h4>
                    </div>
                    <div class="container-text mb-4">
                        <div class="f-text">
                            <p>I can help your business to</p>
                        </div>
                        <div class="l-text">
                            <h1>Get online and <br>grow fast.</h1>
                        </div>
                    </div>
                    <div class="join-text">
                        <button class="btn btn-primary">
                            <a href="#contact" class="text-white text-decoration-none">Schedule free online meeting</a>
                        </button>
                    </div>
                </div>
                <div class="col-md-6 text-center">
                    <div class="card">
                        <div class="image">
                            <img src="image/shema.png" alt="SHEMA Roger" class="img-fluid">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
        <section id="about">
            <div class="about-text">
                <h1>As a passionate software engineer, I specialize in <br>
                crafting high-quality software solutions using a <br>
                diverse range of technologies. My key areas of <br>
                expertise include:</h1>
                <h2>
                C#: Utilizing the .NET framework to develop robust and scalable applications.<br>
                JavaScript: Creating dynamic, interactive web interfaces with cutting-edge JavaScript frameworks.<br>
                Java: Building versatile applications suitable for various platforms, from desktop to enterprise environments.<br>
                React: Designing responsive, user-friendly web applications with React.js.<br>
                Spring Boot: Developing powerful, efficient back-end services and RESTful APIs.<br>
                Linux: Managing system administration and shell scripting to ensure efficient and secure software deployments.
                </h2>
                <h3>
                I thrive in team-oriented environments and am always eager to embrace new technologies and methodologies.<br> 
                My goal is to continually enhance my skills and contribute to impactful projects that make a difference.
                </h3>
            </div>
        </section>
       <section id="portfolio">
    <h1>PORTFOLIO</h1>
    <div class="portfolio-grid">
        <div class="portfolio-row">
            <div class="portfolio-card voting-bg">
                <img src="image/voting-card.jpeg" alt="Project 1">
                <h4>Voting management system</h4>
                <p>A voting system is a secure platform for casting, managing, and tallying votes, ensuring accuracy and transparency in elections.</p>
                <h4>Duration: 2 weeks</h4>
                <button><a href="https://github.com/shemaroger/Voting">Visit Me</a></button>
            </div>
            <div class="portfolio-card market-bg">
                <img src="image/supper-market.jpeg" alt="Project 2">
                <h4>Super market website</h4>
                <p>A supermarket website allows customers to browse, purchase groceries, and household items online, offering convenience and home delivery services.</p>
                <h4>Duration: 4 weeks</h4>
                <button><a href="https://github.com/shemaroger/SimbaSupperMarket">Visit Me</a></button>
            </div>
            <div class="portfolio-card harvest-bg">
                <img src="image/Havest-mgt.jpeg" alt="Project 3">
                <h4>Harvest management system</h4>
                <p>A harvest management system optimizes the planning, tracking, and reporting of crop yields, ensuring efficient and sustainable agricultural practices.</p>
                <h4>Duration: 4 weeks</h4>
                <button><a href="https://github.com/shemaroger/Harvest-">Visit Me</a></button>
            </div>
        </div>
        <div class="portfolio-row">
            <div class="portfolio-card event-bg">
                <img src="image/sit-reservation.jpeg" alt="Project 4">
                <h4>Event sits reservation system</h4>
                <p>An event site reservation system enables users to book, manage, and organize event venues and seating arrangements efficiently and conveniently.</p>
                <h4>Duration: 3 weeks</h4>
                <button><a href="https://github.com/shemaroger/Event-sits-reservation">Visit Me</a></button>
            </div>
            <div class="portfolio-card guard-bg">
                <img src="image/security.jpeg" alt="Project 5">
                <h4>Guards deployment solution</h4>
                <p>A guards deployment solution streamlines the scheduling, tracking, and management of security personnel, ensuring optimal coverage and efficiency.</p>
                <h4>Duration: 5 weeks</h4>
                <button><a href="https://github.com/shemaroger/Guard-deployment">Visit Me</a></button>
            </div>
            <div class="portfolio-card ecommerce-bg">
                <img src="image/shop.jpeg" alt="Project 6">
                <h4>E-commerce</h4>
                <p>An e-commerce platform enables businesses to sell products and services online, providing a convenient and secure shopping experience for customers.</p>
                <h4>Duration: 7 weeks</h4>
                <button><a href="https://github.com/shemaroger/art-ecommerce">Visit Me</a></button>
            </div>
            
        </div>
    </div>
</section>
 <section class="blogs" id="blogs">
    <div class="container">
        <h1 class="my-4">BLOGS</h1>
        <div id="blogContainer"></div>

        <!-- Comment Modal -->
        <div class="modal fade" id="commentModal" tabindex="-1" aria-labelledby="commentModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="commentModalLabel">Comments</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <!-- Comments will be displayed here -->
                        <div id="commentsContainer" class="comments-container mb-3"></div>
                        <!-- Add Comment Form -->
                        <form id="addCommentForm">
                            <div class="mb-3">
                                <label for="commentContent" class="form-label">Add a comment</label>
                                <textarea class="form-control" id="commentContent" rows="2" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Post</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bootstrap Icons CDN -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">

        <!-- JavaScript -->
        <script>
            // Retrieve token from localStorage and check if it exists
            const token = localStorage.getItem('token');

            function isTokenExpired(token) {
                try {
                    const payloadBase64 = token.split('.')[1];
                    const decodedPayload = JSON.parse(atob(payloadBase64));
                    const currentTime = Math.floor(Date.now() / 1000);
                    return decodedPayload.exp < currentTime;
                } catch (error) {
                    console.error('Error decoding token:', error);
                    return true;
                }
            }

            function validateToken() {
                if (!token) {
                    alert('No token found. Please log in.');
                    window.location.href = '/login';
                    return false;
                }

                if (isTokenExpired(token)) {
                    alert('Token has expired. Please log in again.');
                    localStorage.removeItem('token');
                    window.location.href = '/login';
                    return false;
                }

                return true;
            }

            // Fetch Blogs with Token Validation
            async function fetchBlogs() {
                if (!validateToken()) return;

                try {
                    console.log('Fetching blogs...');
                    console.log('Token:', token);

                    const response = await fetch('https://my-blogs-hfeb.onrender.com/api/blogs', {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    console.log('Response status:', response.status);

                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`Failed to fetch blogs: ${response.status} ${response.statusText}. ${errorText}`);
                    }

                    const blogs = await response.json();
                    console.log('Fetched blogs:', blogs);

                    const blogContainer = document.getElementById('blogContainer');
                    if (!blogContainer) {
                        console.error('Blog container element not found');
                        return;
                    }

                    blogContainer.innerHTML = '';

                    blogs.forEach(blog => {
                        const card = document.createElement('div');
                        card.className = 'blog-card';
                        card.dataset.id = blog._id;

                        card.innerHTML = `
                            <img src="${blog.image || 'https://via.placeholder.com/420x300'}" alt="Blog post image" class="blog-card-image">
                            <div class="blog-content">
                                <h2 class="blog-card-title">${blog.title}</h2>
                                <p class="blog-card-excerpt">${blog.content.substring(0, 150)}...</p>
                                <h3 class="blog-card-date">${new Date(blog.date).toLocaleDateString()}</h3>
                                <button class="btn btn-primary icon-button" onclick="toggleLike('${blog._id}')">
                                    <i class="bi bi-heart"></i> <span id="likes-count-${blog._id}">${blog.likes.length}</span>
                                </button>
                                <button class="btn btn-info icon-button" onclick="openCommentModal('${blog._id}')">
                                    <i class="bi bi-chat-dots"></i> Comment
                                </button>
                            </div>
                        `;

                        blogContainer.appendChild(card);
                    });
                } catch (error) {
                    console.error('Error fetching blogs:', error);
                    alert(`Failed to fetch blogs. Error: ${error.message}`);
                }
            }

            // Toggle Like with Token Validation
            async function toggleLike(blogId) {
                if (!validateToken()) return;

                try {
                    console.log(`Toggling like for blog: ${blogId}`);

                    const response = await fetch(`https://my-blogs-hfeb.onrender.com/api/blogs/${blogId}/like`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    console.log('Like toggle response status:', response.status);

                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`Failed to toggle like: ${response.status} ${response.statusText}. ${errorText}`);
                    }

                    const result = await response.json();
                    console.log('Like result:', result);

                    const likesCountElement = document.querySelector(`#likes-count-${blogId}`);
                    if (likesCountElement) {
                        likesCountElement.textContent = `${result.likes} Likes`;
                    } else {
                        console.error(`Likes count element not found for blog: ${blogId}`);
                    }
                } catch (error) {
                    console.error('Error toggling like:', error);
                    alert(`Failed to update like. Error: ${error.message}`);
                }
            }

            // Add Comment with Token Validation
            async function addComment(blogId, commentContent) {
                if (!validateToken()) return;

                if (!commentContent) {
                    alert('Comment cannot be empty');
                    return;
                }

                try {
                    console.log(`Adding comment to blog: ${blogId}`);

                    const response = await fetch(`https://my-blogs-hfeb.onrender.com/api/blogs/${blogId}/comments`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ content: commentContent })
                    });

                    console.log('Add comment response status:', response.status);

                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`Failed to add comment: ${response.status} ${response.statusText}. ${errorText}`);
                    }

                    // Refresh comments and close modal
                    loadComments(blogId);
                    $('#commentModal').modal('hide');
                } catch (error) {
                    console.error('Error adding comment:', error);
                    alert(`Failed to add comment. Error: ${error.message}`);
                }
            }

            // Load Comments into the modal
            async function loadComments(blogId) {
                try {
                    console.log(`Loading comments for blog: ${blogId}`);

                    const response = await fetch(`https://my-blogs-hfeb.onrender.com/api/blogs/${blogId}/comments`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    console.log('Load comments response status:', response.status);

                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`Failed to load comments: ${response.status} ${response.statusText}. ${errorText}`);
                    }

                    const comments = await response.json();
                    console.log(`Fetched ${comments.length} comments for blog: ${blogId}`);
                    console.log('Comments data:', comments);

                    const commentsContainer = document.getElementById('commentsContainer');
                    if (!commentsContainer) {
                        console.error('Comments container not found in modal');
                        return;
                    }

                    commentsContainer.innerHTML = '';

                    comments.forEach(comment => {
                        const commentDiv = document.createElement('div');
                        commentDiv.className = 'comment';

                        const authorIcon = `<i class="bi bi-person comment-icon"></i>`;
                        const authorEmail = comment.author?.email || 'Anonymous';
                        commentDiv.innerHTML = `
                            <div class="d-flex align-items-start">
                                ${authorIcon}
                                <div class="comment-body ms-2">
                                    <div class="comment-author">${authorEmail}</div>
                                    <div class="comment-text">${comment.content}</div>
                                    <div class="comment-time">${new Date(comment.timestamp).toLocaleString()}</div>
                                </div>
                            </div>
                        `;

                        commentsContainer.appendChild(commentDiv);
                    });
                } catch (error) {
                    console.error('Error loading comments:', error);
                    alert(`Failed to load comments. Error: ${error.message}`);
                }
            }

            // Open Comment Modal and load existing comments
            function openCommentModal(blogId) {
                $('#commentModal').modal('show');
                document.getElementById('addCommentForm').onsubmit = function(event) {
                    event.preventDefault();
                    const commentContent = document.getElementById('commentContent').value.trim();
                    addComment(blogId, commentContent);
                };

                // Load existing comments into the modal
                loadComments(blogId);
            }

            // Initial Fetch
            fetchBlogs();
        </script>
    </div>
</section>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

        
       <section id="contact">
       <div class="contact-header">
    <h1>Schedule Free Online Meeting</h1>
    </div>
    <form class="contact-form">
        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required>
        </div>
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
            <label for="comment">Comment:</label>
            <textarea id="comment" name="comment" rows="4" required></textarea>
        </div>
        <button type="submit">Contact me</button>
    </form>
   
</section>

    </main>
 <footer>
    <div class="footer-content">
        <div class="email">
            <h3>
                <img src="icons/icons8-email-80.png" alt="Email Icon">
                shemaroger43@gmail.com
                <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <!-- Adjust spacing as needed -->
                <a href="#blogs">Blogs</a>
            </h3>
        </div>
        <div class="design">
            <!-- Add design or additional content here -->
        </div>
    </div>
</footer>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        function adjustPortfolioCards() {
            var cards = document.querySelectorAll('.portfolio-card');
            if (window.innerWidth < 768) {
                // Show fewer cards on smaller screens
                cards.forEach(function(card, index) {
                    if (index >= 6) { // Show only up to 6 cards
                        card.style.display = 'none';
                    } else {
                        card.style.display = 'block';
                    }
                });
            } else {
                // Show all cards on larger screens
                cards.forEach(function(card) {
                    card.style.display = 'block';
                });
            }
        }

        function adjustFooter() {
            var email = document.querySelector('.email');
            if (window.innerWidth < 768) {
                email.style.flexDirection = 'column';
                email.querySelector('a').style.marginTop = '10px';
            } else {
                email.style.flexDirection = 'row';
                email.querySelector('a').style.marginTop = '0';
            }
        }

        window.addEventListener('resize', function() {
            adjustPortfolioCards();
            adjustFooter();
        });

        // Initial adjustments
        adjustPortfolioCards();
        adjustFooter();
    });
</script>

</body>
</html>
